<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Director</title>

    <link href="/stylesheets/master.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/all.js" type="text/javascript"></script>
    <link href='/images/favicon.ico' rel='shortcut icon'>
    <script type="text/javascript">
      $(document).ready(function(){
        $('a#search').click(function () {
          $('#organization_bar .navbar .nav>li a').css("padding","11px 20px 8px");
          $('#organization_bar .navbar .nav>li a#docs').css("padding","14px 20px");
          $('#organization_bar .navbar .nav>li a#search2').css("padding","11px 10px 8px");
          $('#search-on').show();
          $('#search-off').hide();
        });
        $('.cancel-x').click(function () {
          $('#organization_bar .navbar .nav>li a').css("padding","11px 63px 8px");
          $('#organization_bar .navbar .nav>li a#docs').css("padding","14px 20px");
          $('#organization_bar .navbar .nav>li a#search2, #organization_bar .navbar .nav>li a#search').css("padding","16px 20px 15px");
          $('#organization_bar .navbar .nav>li a#getinvolved').css("padding","11px 92px 8px");
          $('#organization_bar .navbar .nav>li#docs-off .docs-list-list a').css("padding","0");
          $('#search-on').hide();
          $('#search-off').show();
        });f
        $(".togglebutton").click(function () {
        var divname= this.value;
          $("#"+divname).show("slow").siblings().hide("slow");
        });
      });
    </script>

    <!--[if lt IE 9]>
    <style>
        #content .container-full {background:  #ebf0fa;}
        .call-to-contribute-box, .column-left, .column-middle, .column-right {background:#e3e8f2}
        #footer {background:#000;}
    </style>
    <![endif]-->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-22181585-1']);
      _gaq.push(['_setDomainName', 'cloudfoundry.com']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>

  <body class="docs docs_running docs_running_bosh docs_running_bosh_components docs_running_bosh_components_director">
    <img id="bg" src="/images/bg-plain-x.jpg">
    <div id='non_footer'>
      <div id='header'>
        <div class='container_wide'>
          <ul class='actions'>
            <li class='last'>
              <a href="http://www.cloudfoundry.com/contact">Contact Us</a>
            </li>
            <li>
              <a class='register_link' href='http://login.run.pivotal.io/login'>My Account</a>            
            </li>
          </ul>
        </div>
      </div>
      <div id='content'>
        <div class='logo-main'>
          <div class='logo'>
            <a href='http://www.cloudfoundry.com'>
            <img src='/images/logo-cloudfoundry.png'>
            </a>
            <a href='http://www.gopivotal.com' target="_blank">
            <img id="pivotal-logo" src='/images/logo-pivotal.png'>
            </a>
          </div>
          <div class='cta'>
            <a href='https://console.run.pivotal.io'>
            <img src='/images/signup_freetrial.png'>
            </a>
          </div>
        </div><!-- End of logo-main-->
        <div class='container-full'>
          <div id='organization_bar'>
            <div class='navbar'>
              <ul class='nav'>
                <li>
                <a href='http://www.cloudfoundry.com/use' id='use'>Using Cloud Foundry</a>
                </li>
                <li>
                <a href='http://www.cloudfoundry.com/run' id='run'>Running Cloud Foundry</a>
                </li>
                <li>
                <a href='http://www.cloudfoundry.com/getinvolved' id='getinvolved'>Get Involved</a>
                </li>
                <li id='docs-off'>
                  <a href='/' id='docs'>
                    <div id='icon-docs'></div>
                  </a>
                  <div id='docs-list'>
                    <div class="docs-list-list">
                      <a class="docs-list-th" href='/docs/using/app-arch/'>Using Cloud Foundry</a>
                      <br>
                      <a href="/docs/using/app-arch/">Application Architecture Considerations</a>
                      <br>
                      <a href='/docs/using/deploying-apps/'>Deploying Apps</a>
                      <br>
                      <a href='/docs/using/managing-apps/'>Managing Apps</a>
                      <br>
                      <a href='/docs/using/services.html'>Using Services</a>
                      <br>
                      <a class="docs-list-see-all" href="/docs/using/">See all</a>
                    </div><!-- End of 1st column docs-list-list-->
                    <div class="hr-vertical"></div>
                    <div class="docs-list-list">
                      <a class="docs-list-th" href='/docs/running/'>Running Cloud Foundry</a>
                      <br>
                      <a href='/docs/running/architecture/'>Architecture</a>
                      <br>
                      <a href='/docs/running/bosh/'>BOSH</a>
                      <br>
                      <a href='/docs/running/deploying-cf/'>Deploying with BOSH</a>
                      <br>
                      <a href='/docs/running/deploying-cf-with-chef/'>Deploying with Chef</a>
                      <br>
                      <a href='/docs/running/micro_cloud_foundry/'>Micro Cloud Foundry</a>
                      <br>
                      <a href='/docs/running/managing-cf/index.html'>Managing Cloud Foundry</a>
                      <br>
                      <a class="docs-list-see-all" href="/docs/running/">See all</a>
                    </div><!-- End of column 2 docs-list-list -->
                    <div class="hr-vertical"></div>
                    <div class="docs-list-list">
                      <a class="docs-list-th" href='/docs/reference/'>Reference</a>
                      <br>
                      <a href='/docs/reference/cc-api.html'>Cloud Foundry REST API</a>
                      <br>
                      <a class="docs-list-th" href='/docs/dotcom/'>CloudFoundry.com</a>
                      <br>
                      <a href='/docs/dotcom/integration/'>Technical Integration</a>
                      <br>
                      <a class="docs-list-th" href='/docs/community/'>Community</a>
                    </div><!-- End of column 3 docs-list-list -->
                  </div><!-- End of docs-list -->
                </li>
                <li id='search-off'>
                  <a id='search'>
                    <div class='icon-search'></div>
                  </a>
                </li>
                <li id='search-on'>
                  <a id='search2'>
                    <form action='http://www.cloudfoundry.com/search' class='search-form' method='get' onsubmit='return submitQuery()'>
                      <input autocomplete='off' class='search-input' id='search-query' name='q' onfocus="this.placeholder = ''" placeholder='' type='search' value=''>
                    </form>
                    <div class="cancel-x"></div>
                  </a>
                </li>
              </ul>
            </div><!-- End of navbar -->
          </div><!-- End of organization_bar -->
          <div class='content_inner'>
            <a class="forkme" href="http://github.com/cloudfoundry/cf-docs" target="_blank">
              <img alt="Fork me on GitHub" src="/images/ribbon_forkme.png">
            </a>
            <form action='http://www.cloudfoundry.com/search' class='search-docs-form' method='get' onsubmit='return submitQuery()'>
              <input autocomplete='off' class='search-docs-input' id='search-query' name='q' onfocus="this.placeholder = 'more:docs '" placeholder='' type='search-docs' value='more:docs '>
            </form>
            <br clear="left">
            
              <div class="breadcrumbs">
                <ul>
                  <li>
                    <a href="/">Home</a>
                  </li>
                  <li class=""><a href="/docs/running/">Running Cloud Foundry</a></li> <li class=""><a href="/docs/running/bosh/">BOSH</a></li> <li class=""><a href="/docs/running/bosh/components/">BOSH Components</a></li> <li class="active"><span>Director</span></li>
                </ul>
              </div>
              <br clear="left">

			

              <div class="quick-links"><ul>
<li><a href="#deployment-manager">Deployment Manager</a></li>
<li><a href="#instance-manager">Instance Manager</a></li>
<li><a href="#problem-manager">Problem Manager</a></li>
<li><a href="#property-manager">Property Manager</a></li>
<li><a href="#resource-manager">Resource Manager</a></li>
<li><a href="#release-manager">Release Manager</a></li>
<li><a href="#stemcell-manager">Stemcell Manager</a></li>
<li><a href="#task-manager">Task Manager</a></li>
<li><a href="#user-manager">User Manager</a></li>
<li><a href="#vm-state-manager">VM State Manager</a></li>
</ul>
</div>

              <h1>Director</h1>

            
            <p>The Director is the core orchestrating component in BOSH. It controls creation of VMs, deployment, and other life cycle events of software and services. Command and control is handed over to the the Director-Agent interaction after the CPI has created resources.</p>

<p>Specific subcomponents manage the tasks mentioned above. These components are instances of the following classes referenced from the ApiController.</p>

<p><img alt="director-components" src="/images/director-components.png" /></p>

<h3><a id="deployment-manager"></a>Deployment Manager</h3>

<p>Responsible for creating, updating, and deleting the deployments that are specified in the deployment file. Endpoints and Http Method type exposed by the director that are used to access the Deployment Manager are described below.</p>

<table><thead>
<tr>
<th>URL</th>
<th>Http Method Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>/deployments</td>
<td>POST</td>
<td></td>
</tr>
<tr>
<td>/deployments/:deployment/jobs/:job</td>
<td>PUT</td>
<td>Change the state of a job in a deployment based on the parameter</td>
</tr>
<tr>
<td>/deployments/:deployment/jobs/:job/:index/logs</td>
<td>GET</td>
<td>Get logs of a particular job in a deployment</td>
</tr>
<tr>
<td>/deployments/:name</td>
<td>DELETE</td>
<td>Delete a deployment</td>
</tr>
</tbody></table>

<h3><a id="instance-manager"></a>Instance Manager</h3>

<p>Instance Manager helps manage VM instances that are created using Bosh deployments.</p>

<p>It helps connect to the VM instance through an Agent Client using ssh, finds an instance, and fetches the log from a particular instance.</p>

<p>The figure below describes the flow when a user tries to SSH into a VM using Bosh CLI.</p>

<p><img alt="director-instance_manager_1" src="/images/director-instance_manager_1.png" /></p>

<h3><a id="problem-manager"></a>Problem Manager</h3>

<p>This component helps scan a deployment for problems and helps apply resolutions.
It uses a model deployment_problem to keep info about the problem and has a one-to-many relationship with Deployment Model.</p>

<h3><a id="property-manager"></a>Property Manager</h3>

<p>Properties are attributes specified for jobs in the deployment file.
The Property Manager allows you to find properties associated with a deployment and update a particular property for a deployment. It references the Deployment Manager.</p>

<h3><a id="resource-manager"></a>Resource Manager</h3>

<p>The Resource Manager provides access to the resources stored in the BlobStore. Some of the actions performed through a resource manager are:</p>
<pre class="highlight text">1. Get a Resource using an Id
2. Delete a resource by giving an resource Id
3. Get the resource path from an Id
</pre>
<h3><a id="release-manager"></a>Release Manager</h3>

<p>The Release Manager manages the creation and deletion of releases. Each release references a Release Manager and contains a Deployment Plan object as well as an array of templates.</p>

<p>The Director routes the request coming at the following endpoints to the release manager for managing the release lifecycle.</p>

<table><thead>
<tr>
<th>URL</th>
<th>Http Method Type</th>
<th>Response Body</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>/releases</td>
<td>GET</td>
<td>{&ldquo;name&rdquo;     =&gt; release.name,&ldquo;versions&rdquo; =&gt; versions, &ldquo;in<em>use&rdquo;   =&gt; versions</em>in_use}</td>
<td>Get the list of all releases uploaded</td>
</tr>
<tr>
<td>/releases</td>
<td>POST</td>
<td></td>
<td>Create a release for the user specified.</td>
</tr>
</tbody></table>

<h4>Lifecycle of a Release</h4>

<p>The figure below shows the interaction between various components of a Director when a release is created/ updated or deleted.</p>

<p><img alt="release-lifecycle" src="/images/director-release-manager.png" /></p>

<h3><a id="stemcell-manager"></a>Stemcell Manager</h3>

<p>The Stemcell Manager manages the Stem cells. It is responsible for creating, deleting or finding a stemcell.</p>

<p><img alt="director-stemcell-manager" src="/images/director-stemcell-manager.png" /></p>

<p>The table below shows the endpoints exposed by the director for managing the stemcell&#39;s lifecycle.</p>

<table><thead>
<tr>
<th>URL</th>
<th>Http Method Type</th>
<th>Response Body</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>/stemcells</td>
<td>GET</td>
<td>{ &ldquo;name&rdquo; =&gt; stemcell.name, &ldquo;version&rdquo; =&gt; stemcell.version, &ldquo;cid&rdquo;     =&gt; stemcell.cid}</td>
<td>Json specifying the stemcell  name, version and cid of the stem cell.</td>
</tr>
<tr>
<td>/stemcells</td>
<td>POST</td>
<td></td>
<td>Stemcell binary file</td>
</tr>
<tr>
<td>/stemcells</td>
<td>DELETE</td>
<td></td>
<td>Delete the specified stemcell</td>
</tr>
</tbody></table>

<h3><a id="task-manager"></a>Task Manager</h3>

<p>The Task Manager is responsible for managing the tasks which are created and are being run by the Job Runner.</p>

<p><img alt="director-task-manager" src="/images/director-task-manager.png" /></p>

<p>The following http endpoints are exposed by the Director to get information about a task.</p>

<table><thead>
<tr>
<th>URL</th>
<th>Http Method Type</th>
<th>Response Body</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>/tasks</td>
<td>GET</td>
<td></td>
<td>Get all the tasks being executed of type&quot;update<em>deployment&quot;, &ldquo;delete</em>deployment&rdquo;, &ldquo;update<em>release&rdquo;,&ldquo;delete</em>release&rdquo;, &ldquo;update<em>stemcell&rdquo;, &ldquo;delete</em>stemcell&rdquo;</td>
</tr>
<tr>
<td>/tasks/:id</td>
<td>GET</td>
<td></td>
<td>Send back output for a task with the given id</td>
</tr>
<tr>
<td>/tasks/:id/output</td>
<td>GET</td>
<td></td>
<td>Sends back output of given task id and params[:type]</td>
</tr>
<tr>
<td>/task/:id</td>
<td>DELETE</td>
<td></td>
<td>Delete the task specified by a particular Id</td>
</tr>
</tbody></table>

<h3><a id="user-manager"></a>User Manager</h3>

<p>Manages the users stored in the Director’s database. Main functions performed by the User Manager are</p>
<pre class="highlight text">1. Create a User
2. Delete a User
3. Authenticate a User
4. Get a User
5. Update a User
</pre>
<p>User Management is delegated by the director to the User Manager with the following URLs</p>

<table><thead>
<tr>
<th>URL</th>
<th>Http Method Type</th>
<th>Http Request Body</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>/users</td>
<td>POST</td>
<td></td>
<td>Create a User</td>
</tr>
<tr>
<td>/users/:username</td>
<td>PUT</td>
<td></td>
<td>Update a User</td>
</tr>
<tr>
<td>/users/:username</td>
<td>DELETE</td>
<td></td>
<td>Delete a User</td>
</tr>
</tbody></table>

<h3><a id="vm-state-manager"></a>VM State Manager</h3>

<p>Helps fetch the VM State by creating a task which runs the Hob : VmState </p>

<p>The vm state is fetched by creating a GET request on the <code>/deployments/:name/vms</code> endpoint in the Director. <code>name</code> is the name of the deployment.</p>

<p><img alt="director-vm-state-manager" src="/images/director-vm-state-manager.png" /></p>

          </div><!-- End of content_inner -->
        </div><!-- End of container-full -->
      </div><!-- End of content -->
    </div><!-- End of non_footer -->
    <div id='footer'>
      <div id='container-footer'>
        <div class='bg_social'>
          <ul class='social'>
            <li>
            <a href='http://twitter.com/cloudfoundry' target='_blank'>
            <img alt='Twitter' src='/images/twitter_large.png'>
            </a>
            </li>
            <li>
            <a href='https://plus.google.com/114245065906861739918/posts' target='_blank'>
            <img alt='Google+' src='/images/g+_large.png'>
            </a>
            </li>
            <li>
            <a href='http://facebook.com/cloudfoundry' target='_blank'>
            <img alt='Facebook' src='/images/facebook_large.png'>
            </a>
            </li>
            <li>
            <a href='http://youtube.com/cloudfoundry' target='_blank'>
            <img alt='Youtube' src='/images/youtube_large.png'>
            </a>
            </li>
          </ul>
        </div><!-- End of bg_social -->
        <ul class='links'>
          <li>
          <a href='http://www.cloudfoundry.com/about'>About</a>
          </li>
          <li class='disc'>•</li>
          <li>
          <a href='http://blog.cloudfoundry.com/'>Blog</a>
          </li>
          <li class='disc'>•</li>
          <li>
          <a href='http://www.cloudfoundry.com/partners'>Partners</a>
          </li>
          <li class='disc'>•</li>
          <li>
          <a href='http://docs.cloudfoundry.com'>Docs</a>
          </li>
          <li class='disc'>•</li>
          <li>
          <a href='http://www.cloudfoundry.com/faq'>FAQ</a>
          </li>
          <li class='disc'>•</li>
          <li>
          <a href='http://www.cloudfoundry.com/getinvolved'>Get Involved</a>
          </li>
          <li class='disc'>•</li>
          <li>
          <a href='http://status.cloudfoundry.com/'>Status</a>
          </li>
          <li class='disc'>•</li>
          <li>
          <a href='http://www.cloudfoundry.com/support'>Support</a>
          </li>
        </ul>
        <div class='copyright'>
          <div class='hr-horizontal-dark'></div>
          <br>
          <p>
            &copy;
            <script>
              //<![CDATA[
                var d = new Date();
                document.write(d.getFullYear());
              //]]>
            </script>
            GoPivotal, Inc. All rights reserved.
            <a href='http://www.cloudfoundry.com/terms'>Terms</a>
            <a href='http://www.gopivotal.com/privacy-policy' target='_blank'>Privacy</a>
          </p>
        </div><!-- End of copyright -->
      </div><!-- End of container-footer -->
    </div><!-- End of footer -->
    <script type="text/javascript">
      (function() {
        var didInit = false;
        function initMunchkin() {
          if(didInit === false) {
            didInit = true;
            Munchkin.init('625-IUJ-009');
          }
        }
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.async = true;
        s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
        s.onreadystatechange = function() {
          if (this.readyState == 'complete' || this.readyState == 'loaded') {
            initMunchkin();
          }
        };
        s.onload = initMunchkin;
        document.getElementsByTagName('head')[0].appendChild(s);
      })();
    </script>
  </body>
</html>
